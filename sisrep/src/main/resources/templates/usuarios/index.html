<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="base/layout :: comum-header"></head>
<body class="sb-nav-fixed">
	<header th:replace="base/layout :: navbar"></header>

	<div id="layoutSidenav">
		<nav th:replace="base/layout :: menu"></nav>

		<div id="layoutSidenav_content">
			<main>
				<div class="container-fluid p-2">
					<div class="row">
						<div class="col-12">
							<nav aria-label="breadcrumb">
								<ol class="breadcrumb">
									<li class="breadcrumb-item"><a th:href="@{/home}"><i
											class="fa-duotone fa-solid fa-house"></i> Dashboard</a></li>
									<li class="breadcrumb-item active">Usuários</li>
								</ol>
							</nav>
						</div>
						<div class="col-12">
							<!-- Mensageria -->
							<div class="alert alert-success" role="alert" th:if="${msgOk}">
								<p th:text="${msgOk}"></p>
							</div>
							<div class="alert alert-danger" role="alert" th:if="${msgErro}">
								<p th:text="${msgErro}"></p>
							</div>
						</div>
						<div class="col-12">
							<div class="card">
								<div
									class="card-header card-header d-flex justify-content-between align-items-center fs-4 pr-custom-text  fw-semibold text-uppercase">
									Usuários <a th:href="@{/usuarios/usuario}"
										class="btn btn-outline-primary"> <i
										class="fa-duotone fa-solid fa-plus"></i> Novo
									</a>


								</div>

								<div class="card-body">
									<div class="row">
										<div class="col-12">
											<!-- Fomr de busca -->
											<form th:action="@{/usuarios}" method="get"
												class="row g-3 align-items-center">
												<!-- Campo de busca por nome -->
												<div class="col-md-4">
													<label class="form-label">Busca por Nome</label>
													<div class="input-group mb-3">

														<input type="text" class="form-control" th:value="${nome}"
															name="nome">
														<button class="btn btn-outline-primary input-group-text"
															type="submit">
															<i class="fa-duotone fa-regular fa-magnifying-glass"></i>
														</button>

													</div>
												</div>
												<div class="col-md-4">
													<label class="form-label">Busca por E-mail</label>
													<div class="input-group mb-3">
														<input type="text" class="form-control"
															th:value="${email}" name="email">
														<button class="btn  btn-outline-primary input-group-text"
															type="submit">
															<i class="fa-duotone fa-regular fa-magnifying-glass"></i>
														</button>

													</div>
												</div>

												<div class="col-md-2">
													<label class="form-label">Status</label>
													<div class="input-group mb-3">
														<select class="form-select " name="ativo"
															onchange="this.form.submit()">
															<option value="">Todos status</option>
															<option th:value="true" th:selected="${ativo == true}">Ativos</option>
															<option th:value="false" th:selected="${ativo == false}">Inativos</option>
														</select>
													</div>

												</div>


												<div class="col-md-2">
													<label class="form-label">Itens por página</label>
													<div class="input-group mb-3">
														<select class="form-select" name="size"
															onchange="this.form.submit()">
															<option th:each="size : ${pageSizes}" th:value="${size}"
																th:text="${size} + ' itens'"
																th:selected="${size == pageSize}"></option>
														</select>
													</div>
												</div>


											</form>


										</div>
										<div class="col-12 border-bottom pb-3 mb-3"></div>


										<div class="col-12">
											<!-- TABELA  -->
											<div class="table-responsive">
												<table
													class="table table-striped table-sm table-hover border">
													<thead class="table-dark">
														<tr class="fs-6 pr-custom-text">
															<th class="text-center pr-th-borda-suave align-middle">Nome</th>
															<th class="text-center pr-th-borda-suave align-middle">E-mail</th>
															<th class="text-center pr-th-borda-suave align-middle">Status</th>
															<th class="text-center align-middle">Ações</th>
														</tr>
													</thead>
													<tbody>
														<tr th:each="usuario : ${usuarios}">
															<td class="align-middle" th:text="${usuario.nome}"></td>
															<td class="align-middle" th:text="${usuario.email}"></td>
															<td class="text-center align-middle"><span
																th:if="${!usuario.inativo}"
																class="badge fs-6 text-center bg-success"> <i
																	class="fa-duotone fs-6 fa-solid fa-check"></i> Ativo
															</span> <span th:if="${usuario.inativo}"
																class="badge text-center fs-6 bg-secondary"><i
																	class="fa-duotone fs-6 fa-solid fa-circle-xmark"></i>
																	Inativo</span></td>
															<td class="align-middle text-center">
															<a
																th:href="@{/usuarios/editar/{id}(id=${usuario.idPessoa})}"
																class="btn btn-sm btn-outline-primary border-0"
																data-bs-toggle="tooltip" data-bs-placement="top" 
																title="Editar usuário"> <i
																	class="fa-duotone fs-5 fa-solid fa-pen-to-square"></i>
															</a> 
															<a
																th:href="@{/usuarios/detalhar/{id}(id=${usuario.idPessoa})}"
																class="btn btn-sm btn-outline-secondary border-0" data-bs-toggle="tooltip" data-bs-placement="top" 
																title="Detalhes do Usuário"> <i
																	class="fa-duotone fs-5 fa-regular fa-square-info"></i>
															</a>
															<a
																th:href="@{/usuarios/detalhar/{id}(id=${usuario.idPessoa})}"
																class="btn btn-sm btn-outline-danger border-0" data-bs-toggle="tooltip" data-bs-placement="top" 
																title="Deletar Usuário"> <i class="fa-duotone fs-5 fa-light fa-trash-can-list"></i>
															</a>
															
															
															</td>
														</tr>
													</tbody>


												</table>
											</div>
											<!-- fim table responsive -->

										</div>

									</div>



								</div>
								<!-- <div class="card-footer">RODAPE</div>-->
								<div class="card-footer d-flex justify-content-between align-items-center">
    <div class="text-muted small">
        Mostrando <span th:text="${currentPage * pageSize + 1}"></span> a 
        <span th:text="${(currentPage + 1) * pageSize > pageResult.totalElements ? pageResult.totalElements : (currentPage + 1) * pageSize}"></span> de 
        <span th:text="${pageResult.totalElements}"></span> registros
    </div>
    
    <nav aria-label="Page navigation">
        <ul class="pagination pagination-sm mb-0">
            <!-- Primeira página -->
            <li class="page-item" th:classappend="${currentPage == 0} ? 'disabled'">
                <a class="page-link" th:href="@{/usuarios(size=${pageSize}, page=0, nome=${nome}, email=${email}, ativo=${ativo})}">
                    <i class="fa-duotone fa-angles-left"></i>
                </a>
            </li>
            
            <!-- Página anterior -->
            <li class="page-item" th:classappend="${currentPage == 0} ? 'disabled'">
                <a class="page-link" th:href="@{/usuarios(size=${pageSize}, page=${currentPage - 1}, nome=${nome}, email=${email}, ativo=${ativo})}">
                    <i class="fa-duotone fa-angle-left"></i>
                </a>
            </li>
            
            <!-- Páginas numeradas -->
            <li th:each="i : ${#numbers.sequence(0, totalPages - 1)}" 
                class="page-item" 
                th:classappend="${i == currentPage} ? 'active'">
                <a class="page-link" 
                   th:href="@{/usuarios(size=${pageSize}, page=${i}, nome=${nome}, email=${email}, ativo=${ativo})}"
                   th:text="${i + 1}"></a>
            </li>
            
            <!-- Próxima página -->
            <li class="page-item" th:classappend="${currentPage == totalPages - 1} ? 'disabled'">
                <a class="page-link" th:href="@{/usuarios(size=${pageSize}, page=${currentPage + 1}, nome=${nome}, email=${email}, ativo=${ativo})}">
                    <i class="fa-duotone fa-angle-right"></i>
                </a>
            </li>
            
            <!-- Última página -->
            <li class="page-item" th:classappend="${currentPage == totalPages - 1} ? 'disabled'">
                <a class="page-link" th:href="@{/usuarios(size=${pageSize}, page=${totalPages - 1}, nome=${nome}, email=${email}, ativo=${ativo})}">
                    <i class="fa-duotone fa-angles-right"></i>
                </a>
            </li>
        </ul>
    </nav>
</div>
							</div>
						</div>

					</div>



				</div>
				<!--FINAL CONTAINER-->
			</main>
			<footer th:replace="base/layout :: footer"></footer>
		</div>
	</div>

	<div th:replace="base/layout :: body-scripts"></div>
</body>
</html>
